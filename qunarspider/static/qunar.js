(function(e){var t={id:"c79a1fa2c06d5ee8eff23d2a3c35062e",filename:"historyBack.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){window.Utils=function(e){function t(t){e(e(t)[0]).on("click",function(t){t.preventDefault();var n=e(this).attr("href");if(n==="#"||n==="javascript:void(0);"){if(document.referrer){if(document.referrer.indexOf("ucenter")>=0){window.history.go(-3)}else{window.history.back()}}else{window.location.replace("/")}}else{window.location=n}})}return{initBackBtn:t}}($)}(t.exports,t,e);e.____MODULES["c79a1fa2c06d5ee8eff23d2a3c35062e"]=t.exports})(this);(function(e){var t={id:"5a342440e6501b9ab1684e1edea13c8b",filename:"back_top.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){window.BackTop=function(e){function h(n){i=e(window);s=e(document);f=e(".b_plan_menu_box");l=e(n);t=l.find(".tool-back");t.replaceWith(e('<a href="#" class="tool-back icon"><i class="tool-font"></i></a>'));t=l.find(".tool-back");setTimeout(function(){d()},200);p()}function p(){i.on("scroll",y).on("resize",d);t.on("click",function(e){e.preventDefault();window.scrollTo(0,0)})}function d(){o=i.height();u=i.width();a=e(".b_banner").height();l.css("bottom",a+5+"px")}function v(t){var n=e(t.target);if(n.hasClass("b_dialog_mask")){return}if(n.parent().parent().hasClass("scrollInnerBox")){return}if(n.parent().parent().parent().hasClass("scrollInnerBox")){return}if(n.hasClass("scrollInnerBox")){return}}function m(){clearTimeout(r);r=setTimeout(w,500)}function y(){if(c){clearTimeout(c)}c=setTimeout(function(){if(window.scrollY>g){l.removeClass("show-fixed-tool")}else{l.addClass("show-fixed-tool")}if(window.scrollY>=o){t.css({visibility:"visible",opacity:"1"})}else{t.css({visibility:"hidden",opacity:"0"})}g=window.scrollY},10)}function b(){window.scrollTo(0,0);setTimeout(function(){window.scrollTo(0,0)},1200)}function w(){if(window.scrollY>=o){t.css({visibility:"visible"});t.animate({opacity:1},500,"ease-out")}}function E(){if(window.scrollY<=20){window.clearInterval(n);window.scrollTo(0,0);return}var e=-Math.floor(window.scrollY*.4);e=e>300?300:e;window.scrollBy(0,e)}var t,n=0,r=0;var i;var s;var o;var u;var a;var f;var l;var c;var g=window.scrollY;return{init:h}}($)}(t.exports,t,e);e.____MODULES["5a342440e6501b9ab1684e1edea13c8b"]=t.exports})(this);(function(e){var t={id:"db62bc269e34459021d4fceeaa57308f",filename:"hogan-2.0.0.amd.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){window.Hogan={};(function(e,t){function a(e){return String(e===null||e===undefined?"":e)}function f(e){e=a(e);return u.test(e)?e.replace(n,"&amp;").replace(r,"&lt;").replace(i,"&gt;").replace(s,"&#39;").replace(o,"&quot;"):e}e.Template=function(e,n,r,i){this.r=e||this.r;this.c=r;this.options=i;this.text=n||"";this.buf=t?[]:""};e.Template.prototype={r:function(e,t,n){return""},v:f,t:a,render:function(t,n,r){return this.ri([t],n||{},r)},ri:function(e,t,n){return this.r(e,t,n)},rp:function(e,t,n,r){var i=n[e];if(!i){return""}if(this.c&&typeof i=="string"){i=this.c.compile(i,this.options)}return i.ri(t,n,r)},rs:function(e,t,n){var r=e[e.length-1];if(!l(r)){n(e,t,this);return}for(var i=0;i<r.length;i++){e.push(r[i]);n(e,t,this);e.pop()}},s:function(e,t,n,r,i,s,o){var u;if(l(e)&&e.length===0){return false}if(typeof e=="function"){e=this.ls(e,t,n,r,i,s,o)}u=e===""||!!e;if(!r&&u&&t){t.push(typeof e=="object"?e:t[t.length-1])}return u},d:function(e,t,n,r){var i=e.split("."),s=this.f(i[0],t,n,r),o=null;if(e==="."&&l(t[t.length-2])){return t[t.length-1]}for(var u=1;u<i.length;u++){if(s&&typeof s=="object"&&i[u]in s){o=s;s=s[i[u]]}else{s=""}}if(r&&!s){return false}if(!r&&typeof s=="function"){t.push(o);s=this.lv(s,t,n);t.pop()}return s},f:function(e,t,n,r){var i=false,s=null,o=false;for(var u=t.length-1;u>=0;u--){s=t[u];if(s&&typeof s=="object"&&e in s){i=s[e];o=true;break}}if(!o){return r?false:""}if(!r&&typeof i=="function"){i=this.lv(i,t,n)}return i},ho:function(e,t,n,r,i){var s=this.c;var o=this.options;o.delimiters=i;var r=e.call(t,r);r=r==null?String(r):r.toString();this.b(s.compile(r,o).render(t,n));return false},b:t?function(e){this.buf.push(e)}:function(e){this.buf+=e},fl:t?function(){var e=this.buf.join("");this.buf=[];return e}:function(){var e=this.buf;this.buf="";return e},ls:function(e,t,n,r,i,s,o){var u=t[t.length-1],a=null;if(!r&&this.c&&e.length>0){return this.ho(e,u,n,this.text.substring(i,s),o)}a=e.call(u);if(typeof a=="function"){if(r){return true}else if(this.c){return this.ho(a,u,n,this.text.substring(i,s),o)}}return a},lv:function(e,t,n){var r=t[t.length-1];var i=e.call(r);if(typeof i=="function"){i=a(i.call(r));if(this.c&&~i.indexOf("{{")){return this.c.compile(i,this.options).render(r,n)}}return a(i)}};var n=/&/g,r=/</g,i=/>/g,s=/\'/g,o=/\"/g,u=/[&<>\"\']/;var l=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"}})(window.Hogan,true);(function(e){function u(e){if(e.n.substr(e.n.length-1)==="}"){e.n=e.n.substring(0,e.n.length-1)}}function a(e){if(e.trim){return e.trim()}return e.replace(/^\s*|\s*$/g,"")}function f(e,t,n){if(t.charAt(n)!=e.charAt(0)){return false}for(var r=1,i=e.length;r<i;r++){if(t.charAt(n+r)!=e.charAt(r)){return false}}return true}function l(e,t,n,r){var i=[],s=null,o=null;while(e.length>0){o=e.shift();if(o.tag=="#"||o.tag=="^"||c(o,r)){n.push(o);o.nodes=l(e,o.tag,n,r);i.push(o)}else if(o.tag=="/"){if(n.length===0){throw new Error("Closing tag without opener: /"+o.n)}s=n.pop();if(o.n!=s.n&&!h(o.n,s.n,r)){throw new Error("Nesting error: "+s.n+" vs. "+o.n)}s.end=o.i;return i}else{i.push(o)}}if(n.length>0){throw new Error("missing closing tag: "+n.pop().n)}return i}function c(e,t){for(var n=0,r=t.length;n<r;n++){if(t[n].o==e.n){e.tag="#";return true}}}function h(e,t,n){for(var r=0,i=n.length;r<i;r++){if(n[r].c==e&&n[r].o==t){return true}}}function p(e){return e.replace(s,"\\\\").replace(n,'\\"').replace(r,"\\n").replace(i,"\\r")}function d(e){return~e.indexOf(".")?"d":"f"}function v(e){var t="";for(var n=0,r=e.length;n<r;n++){var i=e[n].tag;if(i=="#"){t+=m(e[n].nodes,e[n].n,d(e[n].n),e[n].i,e[n].end,e[n].otag+" "+e[n].ctag)}else if(i=="^"){t+=g(e[n].nodes,e[n].n,d(e[n].n))}else if(i=="<"||i==">"){t+=y(e[n])}else if(i=="{"||i=="&"){t+=b(e[n].n,d(e[n].n))}else if(i=="\n"){t+=E('"\\n"'+(e.length-1==n?"":" + i"))}else if(i=="_v"){t+=w(e[n].n,d(e[n].n))}else if(i===undefined){t+=E('"'+p(e[n])+'"')}}return t}function m(e,t,n,r,i,s){return"if(_.s(_."+n+'("'+p(t)+'",c,p,1),'+"c,p,0,"+r+","+i+',"'+s+'")){'+"_.rs(c,p,"+"function(c,p,_){"+v(e)+"});c.pop();}"}function g(e,t,n){return"if(!_.s(_."+n+'("'+p(t)+'",c,p,1),c,p,1,0,0,"")){'+v(e)+"};"}function y(e){return'_.b(_.rp("'+p(e.n)+'",c,p,"'+(e.indent||"")+'"));'}function b(e,t){return"_.b(_.t(_."+t+'("'+p(e)+'",c,p,0)));'}function w(e,t){return"_.b(_.v(_."+t+'("'+p(e)+'",c,p,0)));'}function E(e){return"_.b("+e+");"}var t=/\S/,n=/\"/g,r=/\n/g,i=/\r/g,s=/\\/g,o={"#":1,"^":2,"/":3,"!":4,">":5,"<":6,"=":7,_v:8,"{":9,"&":10};e.scan=function(n,r){function S(){if(v.length>0){m.push(new String(v));v=""}}function x(){var e=true;for(var n=b;n<m.length;n++){e=m[n].tag&&o[m[n].tag]<o["_v"]||!m[n].tag&&m[n].match(t)===null;if(!e){return false}}return e}function T(e,t){S();if(e&&x()){for(var n=b,r;n<m.length;n++){if(!m[n].tag){if((r=m[n+1])&&r.tag==">"){r.indent=m[n].toString()}m.splice(n,1)}}}else if(!t){m.push({tag:"\n"})}g=false;b=m.length}function N(e,t){var n="="+E,r=e.indexOf(n,t),i=a(e.substring(e.indexOf("=",t)+1,r)).split(" ");w=i[0];E=i[1];return r+n.length-1}var i=n.length,s=0,l=1,c=2,h=s,p=null,d=null,v="",m=[],g=false,y=0,b=0,w="{{",E="}}";if(r){r=r.split(" ");w=r[0];E=r[1]}for(y=0;y<i;y++){if(h==s){if(f(w,n,y)){--y;S();h=l}else{if(n.charAt(y)=="\n"){T(g)}else{v+=n.charAt(y)}}}else if(h==l){y+=w.length-1;d=o[n.charAt(y+1)];p=d?n.charAt(y+1):"_v";if(p=="="){y=N(n,y);h=s}else{if(d){y++}h=c}g=y}else{if(f(E,n,y)){m.push({tag:p,n:a(v),otag:w,ctag:E,i:p=="/"?g-E.length:y+w.length});v="";y+=E.length-1;h=s;if(p=="{"){if(E=="}}"){y++}else{u(m[m.length-1])}}}else{v+=n.charAt(y)}}}T(g,true);return m};e.generate=function(t,n,r){var i='var _=this;_.b(i=i||"");'+v(t)+"return _.fl();";if(r.asString){return"function(c,p,i){"+i+";}"}return new e.Template(new Function("c","p","i",i),n,e,r)};e.parse=function(e,t,n){n=n||{};return l(e,"",[],n.sectionTags||[])},e.cache={};e.compile=function(e,t){t=t||{};var n=e+"||"+!!t.asString;var r=this.cache[n];if(r){return r}r=this.generate(this.parse(this.scan(e,t.delimiters),e,t),e,t);return this.cache[n]=r}})(window.Hogan);(function(e,t){e.Mustache={to_html:function(e,n){var r=t.compile(e);return r.render(n)}}})(window,Hogan)}(t.exports,t,e);e.____MODULES["db62bc269e34459021d4fceeaa57308f"]=t.exports})(this);(function(e){var t={id:"fe84b0b9d47dc2feed8b14b3d6c1c878",filename:"index.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(t,n,r){e.____MODULES["db62bc269e34459021d4fceeaa57308f"]}(t.exports,t,e);e.____MODULES["fe84b0b9d47dc2feed8b14b3d6c1c878"]=t.exports})(this);(function(e){var t={id:"05b6de4ab6ec2a064c16614563686c3b",filename:"scrollEnlargetpl.mustache",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){if(typeof window.QTMPL==="undefined")window.QTMPL={};window.QTMPL["scrollEnlargetpl"]=new window.Hogan.Template(function(e,t,n){var r=this;r.b(n=n||"");if(r.s(r.f("imgs",e,t,1),e,t,0,9,455,"{{ }}")){r.rs(e,t,function(e,t,r){r.b('    <li style="position:relative"><img class="ajaxloading small" data-src="');r.b(r.v(r.f("src",e,t,0)));r.b('" src="//source.qunarzz.com/site/images/travel/finish/space_3nd.png" >');r.b("\n"+n);r.b('    <img class="ajaxloading large" data-src="');r.b(r.v(r.f("src",e,t,0)));r.b('" src="//source.qunarzz.com/site/images/travel/finish/space_3nd.png" >');r.b("\n"+n);r.b('    <p style="position:absolute; bottom: 0; padding:5px 10px 0 10px; color:#fff; line-height:32px; z-index:1;background: rgba(0,0,0,.6);width:100%" id=""></p>');r.b("\n"+n);r.b("    </li>");r.b("\n")});e.pop()}if(!r.s(r.f("imgs",e,t,1),e,t,1,0,0,"")){r.b('    <div id="scrollInnerBox" class="scrollInnerBox2">');r.b("\n"+n);r.b('    <ul class="list_item clrfix">');r.b("\n"+n);r.b("    </ul>");r.b("\n"+n);r.b("    </div>");r.b("\n")}return r.fl();});if(typeof t!=="undefined")t.exports=window.QTMPL["scrollEnlargetpl"]}(t.exports,t,e);e.____MODULES["05b6de4ab6ec2a064c16614563686c3b"]=t.exports})(this);(function(e){var t={id:"8dbe743f0e14bfc83c1b136df741ea29",filename:"doubleTapPos.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){(function(e){function p(e,t,n,r){return Math.abs(e-t)>=Math.abs(n-r)?e-t>0?"Left":"Right":n-r>0?"Up":"Down"}function d(){s=null;if(t.last){t.el.trigger("longTap");t={}}}function v(){if(s)clearTimeout(s);s=null}function m(){if(n)clearTimeout(n);if(r)clearTimeout(r);if(i)clearTimeout(i);if(s)clearTimeout(s);n=r=i=s=null;t={}}function g(e){return(e.pointerType=="touch"||e.pointerType==e.MSPOINTER_TYPE_TOUCH)&&e.isPrimary}function y(e,t){return e.type=="pointer"+t||e.type.toLowerCase()=="mspointer"+t}function b(){if(!h)return;e(document).off(c.down,a).off(c.up,f).off(c.move,l).off(c.cancel,m);e(window).off("scroll",m);m();h=false}function w(s){var o,d,w=0,E=0,S,x;b();c=s&&"down"in s?s:"ontouchstart"in document?{down:"touchstart",up:"touchend",move:"touchmove",cancel:"touchcancel"}:"onpointerdown"in document?{down:"pointerdown",up:"pointerup",move:"pointermove",cancel:"pointercancel"}:"onmspointerdown"in document?{down:"MSPointerDown",up:"MSPointerUp",move:"MSPointerMove",cancel:"MSPointerCancel"}:false;if(!c)return;if("MSGesture"in window){u=new MSGesture;u.target=document.body;e(document).bind("MSGestureEnd",function(e){var n=e.velocityX>1?"Right":e.velocityX<-1?"Left":e.velocityY>1?"Down":e.velocityY<-1?"Up":null;if(n){t.el.trigger("swipe");t.el.trigger("swipe"+n)}})}a=function(r){if((x=y(r,"down"))&&!g(r))return;S=x?r:r.touches[0];if(r.touches&&r.touches.length===1&&t.x2){t.x2=undefined;t.y2=undefined}o=Date.now();d=o-(t.last||o);t.el=e("tagName"in S.target?S.target:S.target.parentNode);n&&clearTimeout(n);t.x1=S.pageX;t.y1=S.pageY;if(d>0&&d<=250)t.isDoubleTapPos=true;t.last=o;if(u&&x)u.addPointer(r.pointerId)};l=function(e){if((x=y(e,"move"))&&!g(e))return;S=x?e:e.touches[0];v();t.x2=S.pageX;t.y2=S.pageY;w+=Math.abs(t.x1-t.x2);E+=Math.abs(t.y1-t.y2)};f=function(s){if((x=y(s,"up"))&&!g(s))return;v();if(t.x2&&Math.abs(t.x1-t.x2)>30||t.y2&&Math.abs(t.y1-t.y2)>30)i=setTimeout(function(){if(t.el){t.el.trigger("swipe");t.el.trigger("swipe"+p(t.x1,t.x2,t.y1,t.y2))}t={}},0);else if("last"in t)if(w<30&&E<30){var o={x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2};r=setTimeout(function(){var r=e.Event("tap");r.cancelTouch=m;if(t.el)t.el.trigger(r);if(t.isDoubleTapPos){if(t.el)t.el.trigger("doubleTapPos",o);t={}}else{n=setTimeout(function(){n=null;if(t.el)t.el.trigger("singleTapPos",o);t={}},250)}},0)}else{t={}}w=E=0};e(document).on(c.up,f).on(c.down,a).on(c.move,l);e(document).on(c.cancel,m);e(window).on("scroll",m);h=true}var t={},n,r,i,s,o=750,u,a,f,l,c,h=false;["doubleTapPos","singleTapPos"].forEach(function(t){e.fn[t]=function(e){return this.on(t,e)}});e.touch={setup:w};e(document).ready(w)})(Zepto)}(t.exports,t,e);e.____MODULES["8dbe743f0e14bfc83c1b136df741ea29"]=t.exports})(this);(function(e){var t={id:"cc2198adce492a7016cb60052004643a",filename:"scrollBox.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(t,n,r){e.____MODULES["fe84b0b9d47dc2feed8b14b3d6c1c878"];e.____MODULES["05b6de4ab6ec2a064c16614563686c3b"];e.____MODULES["8dbe743f0e14bfc83c1b136df741ea29"];var i=function(){var e=[],t=null,n=function(){var t=0;for(;t<e.length;t++){e[t].end?e.splice(t--,1):e[t]()}!e.length&&r()},r=function(){clearInterval(t);t=null};return function(r,i,s,o){var u,a,f,l,c,h=new Image;h.src=r;if(h.complete){i.call(h);s&&s.call(h);return}a=h.width;f=h.height;h.onerror=function(){o&&o.call(h);u.end=true;h=h.onload=h.onerror=null};u=function(){l=h.width;c=h.height;if(l!==a||c!==f||l*c>1024){i.call(h);u.end=true}};u();h.onload=function(){!u.end&&u();s&&s.call(h);h=h.onload=h.onerror=null};if(!u.end){e.push(u);if(t===null)t=setInterval(n,40)}}}();(function(e){var t=$(e);var n=$("body");var r=document.documentElement;var s={wrapper:$("#switch_img"),container:"ul",autoPlay:false,list:"li",lazyClass:"ajaxloading",hasNumTip:false,index:0,clipType:"cover",afterScroll:function(){}};var o=function(){return this.init.apply(this,arguments)};o.prototype={init:function(e){var t=this;var n=t.options=$.extend({},s,e);t.contentWidth=r.clientWidth;t.page=n.index||0;t.wrapperEle=n.wrapper;t.container=t.wrapperEle.find(n.container);t.reset();t.orientation=r.clientWidth>r.clientHeight?"h":"v";t.pages>1&&t.createNavs();n.hasNumTip&&t.createNumTip();t.bindEvents();t.setTransform(t.page)},bindEvents:function(){var n=this;var r=e["orientationchange"]?"orientationchange":"resize";t.on(r,$.proxy(n.resize,n));n.container.on("touchstart",$.proxy(n.setStart,n));n.container.on("touchend",$.proxy(n.setEnd,n));n.container.on("touchmove","img.large",$.proxy(n.setMove,n));n.container.on("doubleTapPos","img.small",$.proxy(n.setEnlarge,n));n.container.on("doubleTapPos","img.large",$.proxy(n.setEnsmall,n));n.container.on("transitionend webkitTransitionEnd oTransitionEnd otransitionend animationend webkitAnimationEnd",$.proxy(n.stop,n))},createNavs:function(){var e=this;var t=$('<div class="btns">');var n=[];for(var r=0;r<e.pages;r++){n.push("<span></span>")}e.navsEle=$(n.join(""));e.navsEle.eq(0).addClass("current");t.append(e.navsEle);e.wrapperEle.append(t)},createNumTip:function(){var e=this;e.numTipEle=$('<div class="imgNum">');e.wrapperEle.append(e.numTipEle)},reset:function(){var e=this;var t;e.list=e.container.find(e.options.list);e.pages=e.list.length;e.container.css("width",e.pages+1+"00%");t=e.list.eq(0).clone();e.container.append(t.hide());e.list=e.container.find(e.options.list);e.list.css("width",e.contentWidth);t.show()},resize:function(){var e=this;e.orientation=r.clientWidth>r.clientHeight?"h":"v";e.contentWidth=r.clientWidth;e.list.css("width",e.contentWidth);e.setTransform(e.page)},setStart:function(e){var t=this;t.isRuning=false;t.startX=e.changedTouches[0].pageX;t.smoveX=e.changedTouches[0].clientX;t.smoveY=e.changedTouches[0].clientY;t.smoveTop=parseFloat(e.target.style.top);t.smoveLeft=parseFloat(e.target.style.left)},setMove:function(e){var t=this;t.endX=e.changedTouches[0].clientX-t.smoveX;t.endY=e.changedTouches[0].clientY-t.smoveY;$(e.target).css({top:t.endY+t.smoveTop+"px",left:t.endX+t.smoveLeft+"px"})},setEnd:function(e){var t=this;var n=t.options;var r=e.changedTouches[0].pageX;if(!$(e.target).hasClass("large")){if(t.isRuning||t.startX==r)return;t.isRuning=true;if(r>t.startX){if(t.page<=0){t.setTransform(t.pages,true);t.page=t.pages-1;setTimeout(function(){t.setTransform(t.page)},20)}else{t.page-=1;t.setTransform(t.page)}}else{t.scrollTo()}if(n.afterScroll)n.afterScroll()}},setEnlarge:function(e){var t=this;var n=e._args.x1;var i=e._args.y1;var e=e.target||e.srcElement;i-=e.y;var s=$(e).next(".large");$(e).css({display:"none"});s.css({display:"inline","transform-origin":n+"px "+i+"px 0px",transform:"scale3d("+s[0].naturalWidth/parseInt(e.style.width)+","+s[0].naturalHeight/parseInt(e.style.height)+",1)",transition:"transform 300ms ease-out",width:e.style.width,height:e.style.height,margin:(r.clientHeight-parseInt(e.style.height))/2+"px "+(r.clientWidth-parseInt(e.style.width))/2+"px",position:"absolute",top:"0",left:t.orientation==="h"?(r.clientWidth-parseInt(e.style.width))/2+"px":"0"})},setEnsmall:function(e){var t=this;var n=e._args.x1;var r=e._args.y1;var e=e.target||e.srcElement;r-=e.y;var i=$(e).prev(".small");$(e).css({display:"none","transform-origin":"50% 50% 0",transform:"scale3d(1,1,1)"});i.css({display:"inline"})},stop:function(){var e=this;e.isRuning=false},setTransform:function(e,t){var n=this;var r=e*n.contentWidth*-1;n.container.css({"transition-duration":t?"0ms":"600ms","transition-timing-function":"cubic-bezier(0.1, 0.57, 0.1, 1)",transform:"translate("+r+"px, 0px) translateZ(0px)","-webkit-transform":"translate("+r+"px, 0px) translateZ(0px)"});var i=n.page>=n.pages?0:n.page;n.navsEle&&n.navsEle.removeClass("current").eq(i).addClass("current");n.options.hasNumTip&&n.numTipEle.text(i+1+"/"+n.pages);n.lazyRender(i);!i&&n.lazyRender(n.pages)},scrollTo:function(){var e=this;if(e.page>=e.pages){e.setTransform(0,true);e.page=1;setTimeout(function(){e.setTransform(e.page)},20)}else{e.page+=1;e.setTransform(e.page)}},showPage:function(e){var t=this;t.page=e;t.setTransform(e)},imgRender:function(e,t){var n=this;var s=n.options;e=$(e);var o=e.data("src");if(e){var u="";i(o,function(){if(!e.hasClass("large")&&e.hasClass("small"))e.css({width:"100%",height:"100%"})},function(){if(s.clipType==="cover"){u=this.width>n.contentWidth?"cover":"contain";e.parents("li").css({"background-image":"url("+o+")","background-size":u,"background-repeat":"no-repeat","background-position":"center"});e.hide()}else{var i={};var a=r.clientWidth;var f=r.clientHeight-60;if(n.orientation==="v"){v=a/f;if(this.width/this.height>=v){i.width=a+"px";i.height=a*this.height/this.width+"px"}else{i.width=f*this.width/this.height+"px";i.height=f+"px"}}else{v=f/a;if(this.height/this.width>=v){i.width=f*this.width/this.height+"px";i.height=f+"px"}else{i.width=a+"px";i.height=a*this.height/this.width+"px"}}e[0].src=o;e.css(t||{width:i.width,height:i.height,margin:(r.clientHeight-parseInt(i.height))/2+"px "+(r.clientWidth-parseInt(i.width))/2+"px",display:"inline"})}})}},lazyRender:function(e){var t=this;var n=t.options;var r=t.list.eq(e).find("img");if(r){t.imgRender.call(t,r[0])}if(r.length>1){t.imgRender.call(t,r[1],{display:"none"})}}};var u={holder:".imglist",container:"#scrollInnerBox",contentEle:".list_item",tpl:QTMPL.scrollEnlargetpl};var a=window.popSwipe=function(){return this.init.apply(this,arguments)};$.extend(a.prototype,{init:function(e){var t=this;var n=t.options=$.extend({},u,e);t.bindEvents()},bindEvents:function(){var e=this;n.delegate(e.options.holder+" img","tap",$.proxy(e.show,e))},hide:function(e){var t=this;t.container.hide()},setStart:function(e){e.preventDefault();var t=this;var t=this;t.isRuning=false;t.startY=e.changedTouches[0].pageY;t.startX=e.changedTouches[0].pageX},setEnd:function(e){e.preventDefault();var t=this;var n=e.changedTouches[0].pageY;var r=e.changedTouches[0].pageX;if(t.isRuning||Math.abs(t.startY-n)<=Math.abs(t.startX-r))return;t.isRuning=true;if(!$(e.target).hasClass("small")){return}t.hide()},show:function(e){var t=this;var r=t.options;var i=e.currentTarget;var s=$(i).parents(r.holder).find("img").map(function(e,t){$(t).data("index",e);return{src:$(t).data("src")}});var u="";var a=t.options.tpl.render({imgs:s});var f=$(i).data("index")||0;if(!t.Swipe){u=t.options.tpl.render({});n.append($(u));t.container=$(r.container);t.contentEle=t.container.find(r.contentEle);t.contentEle.html(a);t.Swipe=new o({clipType:"contain",index:f,hasNumTip:true,wrapper:t.container})}else{t.reset(f,a);t.container.show()}var l=document.getElementById("scrollInnerBox");l.addEventListener("touchstart",$.proxy(t.setStart,t),{passive:false});l.addEventListener("touchend",$.proxy(t.setEnd,t),{passive:false})},reset:function(e,t){var n=this;n.Swipe.page=0;n.contentEle.html(t);n.Swipe.reset();n.Swipe.showPage(e)}});if(e.TYPE==="plan"||$(".place_comment_list").length){if($(".note_img").length){new a({holder:".note_img"})}}else if(e.TYPE==="poi"||e.TYPE==="feature"||e.TYPE==="hotel"){new a({holder:".imglist"})}if($("#switch_img").length){new o}})(window)}(t.exports,t,e);e.____MODULES["cc2198adce492a7016cb60052004643a"]=t.exports})(this);(function(e){var t={id:"b50c95c8796bb5ba1a3d6cf1366212a8",filename:"adManager.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){window.ADManager=function(e){function r(r){t=e(r);n=t.find(".btn_close");var i=window.location.href;var o=i.indexOf("baidu_lightapp")>=0||i.indexOf("bdaldglkp")>=0;if(!o){u()}s()}function i(){var t=false;var n=navigator.userAgent;if(n.match("iPhone|iPod|iPad")!=null&&n.indexOf("Mozilla")==0){var r=n.indexOf("Version/");var i=n.indexOf("Mobile/");var s=n.indexOf("Safari/");if(r>0&&r<i&&i<s){var o=e.trim(n.split("Version/")[1].split("Mobile")[0]);if(parseFloat(o)>=6){t=true}}}return t}function s(){n.on("click",o);e(window).on("resize",u)}function o(e){e.preventDefault();t.hide();if(window.localStorage&&window.localStorage.getItem){try{window.localStorage.setItem("isShowAd","false")}catch(e){}}}function u(){var n=e("body").width();if(window.localStorage&&window.localStorage.getItem){if(window.localStorage.getItem("isShowAd")==null){t.removeClass("hide");e(".e_banner .titbox").css({width:n-58-20+"px"})}}}function a(){t.show()}function f(){t.hide()}var t,n;return{init:r,show:a,hide:f}}($)}(t.exports,t,e);e.____MODULES["b50c95c8796bb5ba1a3d6cf1366212a8"]=t.exports})(this);(function(e){var t={id:"aec70870051e386eb31d0d90b1f91396",filename:"log.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){window.TouchLog=function(e){function n(e,t){if(e==undefined||e===""||t==undefined||t===""){return}var n="";if($GLOABL_PARAMS!=""){var n="&"+$GLOABL_PARAMS}var r=new Image;r.width=1;r.height=1;r.src="//bc.qunar.com/clk?s="+e+"&a="+t+n+"&t="+Math.random()}function r(n){t=n;e(document.body).on("touchstart",i)}function i(r){var i=e(r.target);var s=i.data("log")||i.data("beacon");if(s){n(t,s)}else{var o=i.parents();var u;for(var a=0,f=o.length;a<f;a++){u=e(o.get(a));s=u.data("log")||u.data("beacon");if(s){n(t,s);return}}}}var t;return{init:r,send:n}}($)}(t.exports,t,e);e.____MODULES["aec70870051e386eb31d0d90b1f91396"]=t.exports})(this);(function(e){var t={id:"81534f819dbb8f857997bf1900f5d6a6",filename:"iscroll.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){(function(t,n){function O(e){if(s==="")return e;e=e.charAt(0).toUpperCase()+e.substr(1);return s+e}var r=Math,i=n.createElement("div").style,s=function(){var e="t,webkitT,MozT,msT,OT".split(","),t,n=0,r=e.length;for(;n<r;n++){t=e[n]+"ransform";if(t in i){return e[n].substr(0,e[n].length-1)}}return false}(),o=s?"-"+s.toLowerCase()+"-":"",u=O("transform"),a=O("transitionProperty"),f=O("transitionDuration"),l=O("transformOrigin"),c=O("transitionTimingFunction"),h=O("transitionDelay"),p=/android/gi.test(navigator.appVersion),d=/iphone|ipad/gi.test(navigator.appVersion),v=/hp-tablet/gi.test(navigator.appVersion),m=O("perspective")in i,g="ontouchstart"in t&&!v,y=s!==false,b=O("transition")in i,w="onorientationchange"in t?"orientationchange":"resize",E=g?"touchstart":"mousedown",S=g?"touchmove":"mousemove",x=g?"touchend":"mouseup",T=g?"touchcancel":"mouseup",N=function(){if(s===false)return false;var e={"":"transitionend",webkit:"webkitTransitionEnd",Moz:"transitionend",O:"otransitionend",ms:"MSTransitionEnd"};return e[s]}(),C=function(){return t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(e){return setTimeout(e,1)}}(),k=function(){return t.cancelRequestAnimationFrame||t.webkitCancelAnimationFrame||t.webkitCancelRequestAnimationFrame||t.mozCancelRequestAnimationFrame||t.oCancelRequestAnimationFrame||t.msCancelRequestAnimationFrame||clearTimeout}(),L=m?" translateZ(0)":"",A=function(e,r){var i=this,s;i.wrapper=typeof e=="object"?e:n.getElementById(e);i.wrapper.style.overflow="hidden";i.scroller=i.wrapper.children[0];i.options={hScroll:true,vScroll:true,x:0,y:0,bounce:true,bounceLock:false,momentum:true,lockDirection:true,useTransform:true,useTransition:false,topOffset:0,checkDOMChanges:false,handleClick:true,hScrollbar:true,vScrollbar:true,fixedScrollbar:p,hideScrollbar:d,fadeScrollbar:d&&m,scrollbarClass:"",zoom:false,zoomMin:1,zoomMax:4,doubleTapZoom:2,wheelAction:"scroll",snap:false,snapThreshold:1,onRefresh:null,onBeforeScrollStart:function(e){e.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null,onZoomStart:null,onZoom:null,onZoomEnd:null};for(s in r)i.options[s]=r[s];i.x=i.options.x;i.y=i.options.y;i.options.useTransform=y&&i.options.useTransform;i.options.hScrollbar=i.options.hScroll&&i.options.hScrollbar;i.options.vScrollbar=i.options.vScroll&&i.options.vScrollbar;i.options.zoom=i.options.useTransform&&i.options.zoom;i.options.useTransition=b&&i.options.useTransition;if(i.options.zoom&&p){L=""}i.scroller.style[a]=i.options.useTransform?o+"transform":"top left";i.scroller.style[f]="0";i.scroller.style[l]="0 0";if(i.options.useTransition)i.scroller.style[c]="cubic-bezier(0.33,0.66,0.66,1)";if(i.options.useTransform)i.scroller.style[u]="translate("+i.x+"px,"+i.y+"px)"+L;else i.scroller.style.cssText+=";position:absolute;top:"+i.y+"px;left:"+i.x+"px";if(i.options.useTransition)i.options.fixedScrollbar=true;i.refresh();i._bind(w,t);i._bind(E);if(!g){if(i.options.wheelAction!="none"){i._bind("DOMMouseScroll");i._bind("mousewheel")}}if(i.options.checkDOMChanges)i.checkDOMTime=setInterval(function(){i._checkDOMChanges()},500)};A.prototype={enabled:true,x:0,y:0,steps:[],scale:1,currPageX:0,currPageY:0,pagesX:[],pagesY:[],aniTime:null,wheelZoomCount:0,handleEvent:function(e){var t=this;switch(e.type){case E:if(!g&&e.button!==0)return;t._start(e);break;case S:t._move(e);break;case x:case T:t._end(e);break;case w:t._resize();break;case"DOMMouseScroll":case"mousewheel":t._wheel(e);break;case N:t._transitionEnd(e);break}},_checkDOMChanges:function(){if(this.moved||this.zoomed||this.animating||this.scrollerW==this.scroller.offsetWidth*this.scale&&this.scrollerH==this.scroller.offsetHeight*this.scale)return;this.refresh()},_scrollbar:function(e){var t=this,i;if(!t[e+"Scrollbar"]){if(t[e+"ScrollbarWrapper"]){if(y)t[e+"ScrollbarIndicator"].style[u]="";t[e+"ScrollbarWrapper"].parentNode.removeChild(t[e+"ScrollbarWrapper"]);t[e+"ScrollbarWrapper"]=null;t[e+"ScrollbarIndicator"]=null}return}if(!t[e+"ScrollbarWrapper"]){i=n.createElement("div");if(t.options.scrollbarClass)i.className=t.options.scrollbarClass+e.toUpperCase();else i.style.cssText="position:absolute;z-index:100;"+(e=="h"?"height:7px;bottom:1px;left:2px;right:"+(t.vScrollbar?"7":"2")+"px":"width:7px;bottom:"+(t.hScrollbar?"7":"2")+"px;top:2px;right:1px");i.style.cssText+=";pointer-events:none;"+o+"transition-property:opacity;"+o+"transition-duration:"+(t.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(t.options.hideScrollbar?"0":"1");t.wrapper.appendChild(i);t[e+"ScrollbarWrapper"]=i;i=n.createElement("div");if(!t.options.scrollbarClass){i.style.cssText="position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);"+o+"background-clip:padding-box;"+o+"box-sizing:border-box;"+(e=="h"?"height:100%":"width:100%")+";"+o+"border-radius:3px;border-radius:3px"}i.style.cssText+=";pointer-events:none;"+o+"transition-property:"+o+"transform;"+o+"transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);"+o+"transition-duration:0;"+o+"transform: translate(0,0)"+L;if(t.options.useTransition)i.style.cssText+=";"+o+"transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)";t[e+"ScrollbarWrapper"].appendChild(i);t[e+"ScrollbarIndicator"]=i}if(e=="h"){t.hScrollbarSize=t.hScrollbarWrapper.clientWidth;t.hScrollbarIndicatorSize=r.max(r.round(t.hScrollbarSize*t.hScrollbarSize/t.scrollerW),8);t.hScrollbarIndicator.style.width=t.hScrollbarIndicatorSize+"px";t.hScrollbarMaxScroll=t.hScrollbarSize-t.hScrollbarIndicatorSize;t.hScrollbarProp=t.hScrollbarMaxScroll/t.maxScrollX}else{t.vScrollbarSize=t.vScrollbarWrapper.clientHeight;t.vScrollbarIndicatorSize=r.max(r.round(t.vScrollbarSize*t.vScrollbarSize/t.scrollerH),8);t.vScrollbarIndicator.style.height=t.vScrollbarIndicatorSize+"px";t.vScrollbarMaxScroll=t.vScrollbarSize-t.vScrollbarIndicatorSize;t.vScrollbarProp=t.vScrollbarMaxScroll/t.maxScrollY}t._scrollbarPos(e,true)},_resize:function(){var e=this;setTimeout(function(){e.refresh()},p?200:0)},_pos:function(e,t){if(this.zoomed)return;e=this.hScroll?e:0;t=this.vScroll?t:0;if(this.options.useTransform){this.scroller.style[u]="translate("+e+"px,"+t+"px) scale("+this.scale+")"+L}else{e=r.round(e);t=r.round(t);this.scroller.style.left=e+"px";this.scroller.style.top=t+"px"}this.x=e;this.y=t;this._scrollbarPos("h");this._scrollbarPos("v")},_scrollbarPos:function(e,t){var n=this,i=e=="h"?n.x:n.y,s;if(!n[e+"Scrollbar"])return;i=n[e+"ScrollbarProp"]*i;if(i<0){if(!n.options.fixedScrollbar){s=n[e+"ScrollbarIndicatorSize"]+r.round(i*3);if(s<8)s=8;n[e+"ScrollbarIndicator"].style[e=="h"?"width":"height"]=s+"px"}i=0}else if(i>n[e+"ScrollbarMaxScroll"]){if(!n.options.fixedScrollbar){s=n[e+"ScrollbarIndicatorSize"]-r.round((i-n[e+"ScrollbarMaxScroll"])*3);if(s<8)s=8;n[e+"ScrollbarIndicator"].style[e=="h"?"width":"height"]=s+"px";i=n[e+"ScrollbarMaxScroll"]+(n[e+"ScrollbarIndicatorSize"]-s)}else{i=n[e+"ScrollbarMaxScroll"]}}n[e+"ScrollbarWrapper"].style[h]="0";n[e+"ScrollbarWrapper"].style.opacity=t&&n.options.hideScrollbar?"0":"1";n[e+"ScrollbarIndicator"].style[u]="translate("+(e=="h"?i+"px,0)":"0,"+i+"px)")+L},_start:function(e){var n=this,i=g?e.touches[0]:e,s,o,a,f,l;if(!n.enabled)return;if(n.options.onBeforeScrollStart)n.options.onBeforeScrollStart.call(n,e);if(n.options.useTransition||n.options.zoom)n._transitionTime(0);n.moved=false;n.animating=false;n.zoomed=false;n.distX=0;n.distY=0;n.absDistX=0;n.absDistY=0;n.dirX=0;n.dirY=0;if(n.options.zoom&&g&&e.touches.length>1){f=r.abs(e.touches[0].pageX-e.touches[1].pageX);l=r.abs(e.touches[0].pageY-e.touches[1].pageY);n.touchesDistStart=r.sqrt(f*f+l*l);n.originX=r.abs(e.touches[0].pageX+e.touches[1].pageX-n.wrapperOffsetLeft*2)/2-n.x;n.originY=r.abs(e.touches[0].pageY+e.touches[1].pageY-n.wrapperOffsetTop*2)/2-n.y;if(n.options.onZoomStart)n.options.onZoomStart.call(n,e)}if(n.options.momentum){if(n.options.useTransform){s=getComputedStyle(n.scroller,null)[u].replace(/[^0-9\-.,]/g,"").split(",");o=+(s[12]||s[4]);a=+(s[13]||s[5])}else{o=+getComputedStyle(n.scroller,null).left.replace(/[^0-9-]/g,"");a=+getComputedStyle(n.scroller,null).top.replace(/[^0-9-]/g,"")}if(o!=n.x||a!=n.y){if(n.options.useTransition)n._unbind(N);else k(n.aniTime);n.steps=[];n._pos(o,a);if(n.options.onScrollEnd)n.options.onScrollEnd.call(n)}}n.absStartX=n.x;n.absStartY=n.y;n.startX=n.x;n.startY=n.y;n.pointX=i.pageX;n.pointY=i.pageY;n.startTime=e.timeStamp||Date.now();if(n.options.onScrollStart)n.options.onScrollStart.call(n,e);n._bind(S,t);n._bind(x,t);n._bind(T,t)},_move:function(e){var t=this,n=g?e.touches[0]:e,i=n.pageX-t.pointX,s=n.pageY-t.pointY,o=t.x+i,a=t.y+s,f,l,c,h=e.timeStamp||Date.now();if(t.options.onBeforeScrollMove)t.options.onBeforeScrollMove.call(t,e);if(t.options.zoom&&g&&e.touches.length>1){f=r.abs(e.touches[0].pageX-e.touches[1].pageX);l=r.abs(e.touches[0].pageY-e.touches[1].pageY);t.touchesDist=r.sqrt(f*f+l*l);t.zoomed=true;c=1/t.touchesDistStart*t.touchesDist*this.scale;if(c<t.options.zoomMin)c=.5*t.options.zoomMin*Math.pow(2,c/t.options.zoomMin);else if(c>t.options.zoomMax)c=2*t.options.zoomMax*Math.pow(.5,t.options.zoomMax/c);t.lastScale=c/this.scale;o=this.originX-this.originX*t.lastScale+this.x;a=this.originY-this.originY*t.lastScale+this.y;this.scroller.style[u]="translate("+o+"px,"+a+"px) scale("+c+")"+L;if(t.options.onZoom)t.options.onZoom.call(t,e);return}t.pointX=n.pageX;t.pointY=n.pageY;if(o>0||o<t.maxScrollX){o=t.options.bounce?t.x+i/2:o>=0||t.maxScrollX>=0?0:t.maxScrollX}if(a>t.minScrollY||a<t.maxScrollY){a=t.options.bounce?t.y+s/2:a>=t.minScrollY||t.maxScrollY>=0?t.minScrollY:t.maxScrollY}t.distX+=i;t.distY+=s;t.absDistX=r.abs(t.distX);t.absDistY=r.abs(t.distY);if(t.absDistX<6&&t.absDistY<6){return}if(t.options.lockDirection){if(t.absDistX>t.absDistY+5){a=t.y;s=0}else if(t.absDistY>t.absDistX+5){o=t.x;i=0}}t.moved=true;t._pos(o,a);t.dirX=i>0?-1:i<0?1:0;t.dirY=s>0?-1:s<0?1:0;if(h-t.startTime>300){t.startTime=h;t.startX=t.x;t.startY=t.y}if(t.options.onScrollMove)t.options.onScrollMove.call(t,e)},_end:function(e){if(g&&e.touches.length!==0)return;var i=this,s=g?e.changedTouches[0]:e,o,a,l={dist:0,time:0},c={dist:0,time:0},h=(e.timeStamp||Date.now())-i.startTime,p=i.x,d=i.y,v,m,y,b,w;i._unbind(S,t);i._unbind(x,t);i._unbind(T,t);if(i.options.onBeforeScrollEnd)i.options.onBeforeScrollEnd.call(i,e);if(i.zoomed){w=i.scale*i.lastScale;w=Math.max(i.options.zoomMin,w);w=Math.min(i.options.zoomMax,w);i.lastScale=w/i.scale;i.scale=w;i.x=i.originX-i.originX*i.lastScale+i.x;i.y=i.originY-i.originY*i.lastScale+i.y;i.scroller.style[f]="200ms";i.scroller.style[u]="translate("+i.x+"px,"+i.y+"px) scale("+i.scale+")"+L;i.zoomed=false;i.refresh();if(i.options.onZoomEnd)i.options.onZoomEnd.call(i,e);return}if(!i.moved){if(g){if(i.doubleTapTimer&&i.options.zoom){clearTimeout(i.doubleTapTimer);i.doubleTapTimer=null;if(i.options.onZoomStart)i.options.onZoomStart.call(i,e);i.zoom(i.pointX,i.pointY,i.scale==1?i.options.doubleTapZoom:1);if(i.options.onZoomEnd){setTimeout(function(){i.options.onZoomEnd.call(i,e)},200)}}else if(this.options.handleClick){i.doubleTapTimer=setTimeout(function(){i.doubleTapTimer=null;o=s.target;while(o.nodeType!=1)o=o.parentNode;if(o.tagName!="SELECT"&&o.tagName!="INPUT"&&o.tagName!="TEXTAREA"){a=n.createEvent("MouseEvents");a.initMouseEvent("click",true,true,e.view,1,s.screenX,s.screenY,s.clientX,s.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null);a._fake=true;o.dispatchEvent(a)}},i.options.zoom?250:0)}}i._resetPos(400);if(i.options.onTouchEnd)i.options.onTouchEnd.call(i,e);return}if(h<300&&i.options.momentum){l=p?i._momentum(p-i.startX,h,-i.x,i.scrollerW-i.wrapperW+i.x,i.options.bounce?i.wrapperW:0):l;c=d?i._momentum(d-i.startY,h,-i.y,i.maxScrollY<0?i.scrollerH-i.wrapperH+i.y-i.minScrollY:0,i.options.bounce?i.wrapperH:0):c;p=i.x+l.dist;d=i.y+c.dist;if(i.x>0&&p>0||i.x<i.maxScrollX&&p<i.maxScrollX)l={dist:0,time:0};if(i.y>i.minScrollY&&d>i.minScrollY||i.y<i.maxScrollY&&d<i.maxScrollY)c={dist:0,time:0}}if(l.dist||c.dist){y=r.max(r.max(l.time,c.time),10);if(i.options.snap){v=p-i.absStartX;m=d-i.absStartY;if(r.abs(v)<i.options.snapThreshold&&r.abs(m)<i.options.snapThreshold){i.scrollTo(i.absStartX,i.absStartY,200)}else{b=i._snap(p,d);p=b.x;d=b.y;y=r.max(b.time,y)}}i.scrollTo(r.round(p),r.round(d),y);if(i.options.onTouchEnd)i.options.onTouchEnd.call(i,e);return}if(i.options.snap){v=p-i.absStartX;m=d-i.absStartY;if(r.abs(v)<i.options.snapThreshold&&r.abs(m)<i.options.snapThreshold)i.scrollTo(i.absStartX,i.absStartY,200);else{b=i._snap(i.x,i.y);if(b.x!=i.x||b.y!=i.y)i.scrollTo(b.x,b.y,b.time)}if(i.options.onTouchEnd)i.options.onTouchEnd.call(i,e);return}i._resetPos(200);if(i.options.onTouchEnd)i.options.onTouchEnd.call(i,e)},_resetPos:function(e){var t=this,n=t.x>=0?0:t.x<t.maxScrollX?t.maxScrollX:t.x,r=t.y>=t.minScrollY||t.maxScrollY>0?t.minScrollY:t.y<t.maxScrollY?t.maxScrollY:t.y;if(n==t.x&&r==t.y){if(t.moved){t.moved=false;if(t.options.onScrollEnd)t.options.onScrollEnd.call(t)}if(t.hScrollbar&&t.options.hideScrollbar){if(s=="webkit")t.hScrollbarWrapper.style[h]="300ms";t.hScrollbarWrapper.style.opacity="0"}if(t.vScrollbar&&t.options.hideScrollbar){if(s=="webkit")t.vScrollbarWrapper.style[h]="300ms";t.vScrollbarWrapper.style.opacity="0"}return}t.scrollTo(n,r,e||0)},_wheel:function(e){var t=this,n,r,i,s,o;if("wheelDeltaX"in e){n=e.wheelDeltaX/12;r=e.wheelDeltaY/12}else if("wheelDelta"in e){n=r=e.wheelDelta/12}else if("detail"in e){n=r=-e.detail*3}else{return}if(t.options.wheelAction=="zoom"){o=t.scale*Math.pow(2,1/3*(r?r/Math.abs(r):0));if(o<t.options.zoomMin)o=t.options.zoomMin;if(o>t.options.zoomMax)o=t.options.zoomMax;if(o!=t.scale){if(!t.wheelZoomCount&&t.options.onZoomStart)t.options.onZoomStart.call(t,e);t.wheelZoomCount++;t.zoom(e.pageX,e.pageY,o,400);setTimeout(function(){t.wheelZoomCount--;if(!t.wheelZoomCount&&t.options.onZoomEnd)t.options.onZoomEnd.call(t,e)},400)}return}i=t.x+n;s=t.y+r;if(i>0)i=0;else if(i<t.maxScrollX)i=t.maxScrollX;if(s>t.minScrollY)s=t.minScrollY;else if(s<t.maxScrollY)s=t.maxScrollY;if(t.maxScrollY<0){t.scrollTo(i,s,0)}},_transitionEnd:function(e){var t=this;if(e.target!=t.scroller)return;t._unbind(N);t._startAni()},_startAni:function(){var e=this,t=e.x,n=e.y,i=Date.now(),s,o,u;if(e.animating)return;if(!e.steps.length){e._resetPos(400);return}s=e.steps.shift();if(s.x==t&&s.y==n)s.time=0;e.animating=true;e.moved=true;if(e.options.useTransition){e._transitionTime(s.time);e._pos(s.x,s.y);e.animating=false;if(s.time)e._bind(N);else e._resetPos(0);return}u=function(){var a=Date.now(),f,l;if(a>=i+s.time){e._pos(s.x,s.y);e.animating=false;if(e.options.onAnimationEnd)e.options.onAnimationEnd.call(e);e._startAni();return}a=(a-i)/s.time-1;o=r.sqrt(1-a*a);f=(s.x-t)*o+t;l=(s.y-n)*o+n;e._pos(f,l);if(e.animating)e.aniTime=C(u)};u()},_transitionTime:function(e){e+="ms";this.scroller.style[f]=e;if(this.hScrollbar)this.hScrollbarIndicator.style[f]=e;if(this.vScrollbar)this.vScrollbarIndicator.style[f]=e},_momentum:function(e,t,n,i,s){var o=6e-4,u=r.abs(e)/t,a=u*u/(2*o),f=0,l=0;if(e>0&&a>n){l=s/(6/(a/u*o));n=n+l;u=u*n/a;a=n}else if(e<0&&a>i){l=s/(6/(a/u*o));i=i+l;u=u*i/a;a=i}a=a*(e<0?-1:1);f=u/o;return{dist:a,time:r.round(f)}},_offset:function(e){var t=-e.offsetLeft,n=-e.offsetTop;while(e=e.offsetParent){t-=e.offsetLeft;n-=e.offsetTop}if(e!=this.wrapper){t*=this.scale;n*=this.scale}return{left:t,top:n}},_snap:function(e,t){var n=this,i,s,o,u,a,f;o=n.pagesX.length-1;for(i=0,s=n.pagesX.length;i<s;i++){if(e>=n.pagesX[i]){o=i;break}}if(o==n.currPageX&&o>0&&n.dirX<0)o--;e=n.pagesX[o];a=r.abs(e-n.pagesX[n.currPageX]);a=a?r.abs(n.x-e)/a*500:0;n.currPageX=o;o=n.pagesY.length-1;for(i=0;i<o;i++){if(t>=n.pagesY[i]){o=i;break}}if(o==n.currPageY&&o>0&&n.dirY<0)o--;t=n.pagesY[o];f=r.abs(t-n.pagesY[n.currPageY]);f=f?r.abs(n.y-t)/f*500:0;n.currPageY=o;u=r.round(r.max(a,f))||200;return{x:e,y:t,time:u}},_bind:function(e,t,n){(t||this.scroller).addEventListener(e,this,!!n)},_unbind:function(e,t,n){(t||this.scroller).removeEventListener(e,this,!!n)},destroy:function(){var e=this;e.scroller.style[u]="";e.hScrollbar=false;e.vScrollbar=false;e._scrollbar("h");e._scrollbar("v");e._unbind(w,t);e._unbind(E);e._unbind(S,t);e._unbind(x,t);e._unbind(T,t);if(!e.options.hasTouch){e._unbind("DOMMouseScroll");e._unbind("mousewheel")}if(e.options.useTransition)e._unbind(N);if(e.options.checkDOMChanges)clearInterval(e.checkDOMTime);if(e.options.onDestroy)e.options.onDestroy.call(e)},refresh:function(){var e=this,t,n,i,s,o=0,u=0;if(e.scale<e.options.zoomMin)e.scale=e.options.zoomMin;e.wrapperW=e.wrapper.clientWidth||1;e.wrapperH=e.wrapper.clientHeight||1;e.minScrollY=-e.options.topOffset||0;e.scrollerW=r.round(e.scroller.offsetWidth*e.scale);e.scrollerH=r.round((e.scroller.offsetHeight+e.minScrollY)*e.scale);e.maxScrollX=e.wrapperW-e.scrollerW;e.maxScrollY=e.wrapperH-e.scrollerH+e.minScrollY;e.dirX=0;e.dirY=0;if(e.options.onRefresh)e.options.onRefresh.call(e);e.hScroll=e.options.hScroll&&e.maxScrollX<0;e.vScroll=e.options.vScroll&&(!e.options.bounceLock&&!e.hScroll||e.scrollerH>e.wrapperH);e.hScrollbar=e.hScroll&&e.options.hScrollbar;e.vScrollbar=e.vScroll&&e.options.vScrollbar&&e.scrollerH>e.wrapperH;t=e._offset(e.wrapper);e.wrapperOffsetLeft=-t.left;e.wrapperOffsetTop=-t.top;if(typeof e.options.snap=="string"){e.pagesX=[];e.pagesY=[];s=e.scroller.querySelectorAll(e.options.snap);for(n=0,i=s.length;n<i;n++){o=e._offset(s[n]);o.left+=e.wrapperOffsetLeft;o.top+=e.wrapperOffsetTop;e.pagesX[n]=o.left<e.maxScrollX?e.maxScrollX:o.left*e.scale;e.pagesY[n]=o.top<e.maxScrollY?e.maxScrollY:o.top*e.scale}}else if(e.options.snap){e.pagesX=[];while(o>=e.maxScrollX){e.pagesX[u]=o;o=o-e.wrapperW;u++}if(e.maxScrollX%e.wrapperW)e.pagesX[e.pagesX.length]=e.maxScrollX-e.pagesX[e.pagesX.length-1]+e.pagesX[e.pagesX.length-1];o=0;u=0;e.pagesY=[];while(o>=e.maxScrollY){e.pagesY[u]=o;o=o-e.wrapperH;u++}if(e.maxScrollY%e.wrapperH)e.pagesY[e.pagesY.length]=e.maxScrollY-e.pagesY[e.pagesY.length-1]+e.pagesY[e.pagesY.length-1]}e._scrollbar("h");e._scrollbar("v");if(!e.zoomed){e.scroller.style[f]="0";e._resetPos(400)}},scrollTo:function(e,t,n,r){var i=this,s=e,o,u;i.stop();if(!s.length)s=[{x:e,y:t,time:n,relative:r}];for(o=0,u=s.length;o<u;o++){if(s[o].relative){s[o].x=i.x-s[o].x;s[o].y=i.y-s[o].y}i.steps.push({x:s[o].x,y:s[o].y,time:s[o].time||0})}i._startAni()},scrollToElement:function(e,t){var n=this,i;e=e.nodeType?e:n.scroller.querySelector(e);if(!e)return;i=n._offset(e);i.left+=n.wrapperOffsetLeft;i.top+=n.wrapperOffsetTop;i.left=i.left>0?0:i.left<n.maxScrollX?n.maxScrollX:i.left;i.top=i.top>n.minScrollY?n.minScrollY:i.top<n.maxScrollY?n.maxScrollY:i.top;t=t===undefined?r.max(r.abs(i.left)*2,r.abs(i.top)*2):t;n.scrollTo(i.left,i.top,t)},scrollToPage:function(e,t,n){var r=this,i,s;n=n===undefined?400:n;if(r.options.onScrollStart)r.options.onScrollStart.call(r);if(r.options.snap){e=e=="next"?r.currPageX+1:e=="prev"?r.currPageX-1:e;t=t=="next"?r.currPageY+1:t=="prev"?r.currPageY-1:t;e=e<0?0:e>r.pagesX.length-1?r.pagesX.length-1:e;t=t<0?0:t>r.pagesY.length-1?r.pagesY.length-1:t;r.currPageX=e;r.currPageY=t;i=r.pagesX[e];s=r.pagesY[t]}else{i=-r.wrapperW*e;s=-r.wrapperH*t;if(i<r.maxScrollX)i=r.maxScrollX;if(s<r.maxScrollY)s=r.maxScrollY}r.scrollTo(i,s,n)},disable:function(){this.stop();this._resetPos(0);this.enabled=false;this._unbind(S,t);this._unbind(x,t);this._unbind(T,t)},enable:function(){this.enabled=true},stop:function(){if(this.options.useTransition)this._unbind(N);else k(this.aniTime);this.steps=[];this.moved=false;this.animating=false},zoom:function(e,t,n,r){var i=this,s=n/i.scale;if(!i.options.useTransform)return;i.zoomed=true;r=r===undefined?200:r;e=e-i.wrapperOffsetLeft-i.x;t=t-i.wrapperOffsetTop-i.y;i.x=e-e*s+i.x;i.y=t-t*s+i.y;i.scale=n;i.refresh();i.x=i.x>0?0:i.x<i.maxScrollX?i.maxScrollX:i.x;i.y=i.y>i.minScrollY?i.minScrollY:i.y<i.maxScrollY?i.maxScrollY:i.y;i.scroller.style[f]=r+"ms";i.scroller.style[u]="translate("+i.x+"px,"+i.y+"px) scale("+n+")"+L;i.zoomed=false},isReady:function(){return!this.moved&&!this.zoomed&&!this.animating}};i=null;if(typeof e!=="undefined")e.iScroll=A;else t.iScroll=A})(window,document)}(t.exports,t,e);e.____MODULES["81534f819dbb8f857997bf1900f5d6a6"]=t.exports})(this);(function(e){var t={id:"8fb16d9363ae8f2faf3362600ace2d11",filename:"cookie.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){(function(e){function n(e){return u.raw?e:encodeURIComponent(e)}function r(e){return u.raw?e:decodeURIComponent(e)}function i(e){return n(u.json?JSON.stringify(e):String(e))}function s(e){if(e.indexOf('"')===0){e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")}try{e=decodeURIComponent(e.replace(t," "));return u.json?JSON.parse(e):e}catch(n){}}function o(t,n){var r=u.raw?t:s(t);return e.isFunction(n)?n(r):r}var t=/\+/g;var u=e.cookie=function(t,s,a){if(s!==undefined&&!e.isFunction(s)){a=e.extend({},u.defaults,a);if(typeof a.expires==="number"){var f=a.expires,l=a.expires=new Date;l.setTime(+l+f*864e5)}return document.cookie=[n(t),"=",i(s),a.expires?"; expires="+a.expires.toUTCString():"",a.path?"; path="+a.path:"",a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("")}var c=t?undefined:{};var h=document.cookie?document.cookie.split("; "):[];for(var p=0,d=h.length;p<d;p++){var v=h[p].split("=");var m=r(v.shift());var g=v.join("=");if(t&&t===m){c=o(g,s);break}if(!t&&(g=o(g))!==undefined){c[m]=g}}return c};u.defaults={};e.removeCookie=function(t,n){if(e.cookie(t)===undefined){return false}e.cookie(t,"",e.extend({},n,{expires:-1}));return!e.cookie(t)}})(Zepto)}(t.exports,t,e);e.____MODULES["8fb16d9363ae8f2faf3362600ace2d11"]=t.exports})(this);(function(e){var t={id:"4a3d74559aceeb301d012ffb24cb52d3",filename:"dialog.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){function i(){this.initalize.apply(this,arguments)}var r={wrapper:'<div class="pop-dialog"><div class="b_dialogs" style="height:120px;width:100%;margin-left:-50%;"></div></div>',content:".b_dialogs",tpl:'<div class="pop-comment"><textarea maxlength="300" placeholder="说点什么吧~" class="pop-comment-text"></textarea><div style="text-align:right;"><span class="pop-tips"></span><button class="pop-comment-bt pop-comment-bt-disabled" type="button">发布</button></div></div>',maskTpl:'<div class="b_dialog_mask"></div>'};i.prototype={initalize:function(e){var t=this;t.options=$.extend({},r,e);t.data=t.options.data||{};delete t.options.data;t.container=$(t.options.wrapper).appendTo("body");t.render(t.options,t);t.bindEvents(t.options,t)},bindEvents:function(e,t){t.maskEle.on("tap",$.proxy(t.hide,t))},render:function(e,t){t.maskEle=$(e.maskTpl);t.contentEle=t.container.find(e.content);t.container.append(t.maskEle);t.contentEle.html(e.tpl);t.show()},show:function(){var e=this;var t=e.options;var n=$(window).scrollTop();var r=$(window).height();e.container.show();var i=e.contentEle.height();t.afterShowed&&t.afterShowed.apply(e,[e])},hide:function(){var e=this;e.container.hide()}};t.exports={show:function(e){if(n[e.id]){return n[e.id].show()}else{return n[e.id]=new i(e)}},get:function(e){return n[e.id]||{}}}}(t.exports,t,e);e.____MODULES["4a3d74559aceeb301d012ffb24cb52d3"]=t.exports})(this);(function(e){var t={id:"78bcf0a682326d91379b6f32d0782a68",filename:"tpl.mustache",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){if(typeof window.QTMPL==="undefined")window.QTMPL={};window.QTMPL["tpl"]=new window.Hogan.Template(function(e,t,n){var r=this;r.b(n=n||"");if(r.s(r.f("ctype",e,t,1),e,t,0,10,512,"{{ }}")){r.rs(e,t,function(e,t,r){r.b('<dt class="comment-avator inline-block">');r.b("\n"+n);r.b('    <img src="');r.b(r.v(r.d("author.headImg",e,t,0)));r.b('">');r.b("\n"+n);r.b('    <span class="text">');r.b("\n"+n);r.b('        <span class="ft-blue">');r.b(r.v(r.d("author.nickName",e,t,0)));r.b("</span>");r.b("\n"+n);r.b("    </span>");r.b("\n"+n);r.b("</dt>");r.b("\n"+n);r.b('<dd class="comment-text">');r.b(r.v(r.f("body",e,t,0)));r.b("</dd>");r.b("\n"+n);r.b('<dd class="comment-time">');r.b("\n"+n);r.b('    <span data-log="reply" data-id="');r.b(r.v(r.f("id",e,t,0)));r.b('" data-username="');r.b(r.v(r.d("author.nickName",e,t,0)));r.b('" class="replys ft-blue">回复<span class="num_none hide">(<em>0</em>)</span></span>');r.b("\n"+n);r.b(r.v(r.f("modifyTime",e,t,0)));r.b("\n"+n);r.b("</dd>");r.b("\n"+n);r.b('<dd class="comment-reply" data-replyId="');r.b(r.v(r.f("id",e,t,0)));r.b('"><dl class="dl-reply"></dl></dd>');r.b("\n")});e.pop()}r.b("\n"+n);if(!r.s(r.f("ctype",e,t,1),e,t,1,0,0,"")){r.b('    <dt class="comment-avator inline-block type-reply">');r.b("\n"+n);r.b('        <img src="');r.b(r.v(r.d("author.headImg",e,t,0)));r.b('">');r.b("\n"+n);r.b('          <span class="text">');r.b("\n"+n);r.b('              <span data-log="reply" class="ft-blue">');r.b(r.v(r.d("author.nickName",e,t,0)));r.b("</span>");r.b("\n"+n);r.b("                  &nbsp;回复&nbsp;");r.b("\n"+n);r.b('              <span class="ft-blue">');r.b(r.v(r.d("owner.nickName",e,t,0)));r.b("</span>");r.b("\n"+n);r.b("                  ：");r.b("\n"+n);r.b("          </span>");r.b("\n"+n);r.b("    </dt>");r.b("\n"+n);r.b('    <dd class="comment-text">');r.b(r.v(r.f("body",e,t,0)));r.b("</dd>");r.b("\n"+n);r.b('    <dd class="comment-time">');r.b("\n"+n);r.b('        <span data-log="reply" data-id="');r.b(r.v(r.f("id",e,t,0)));r.b('" data-username="');r.b(r.v(r.d("author.nickName",e,t,0)));r.b('" class="replys ft-blue">回复</span>');r.b("\n"+n);r.b("        ");r.b(r.v(r.f("modifyTime",e,t,0)));r.b("</dd>");r.b("\n")}return r.fl();});if(typeof t!=="undefined")t.exports=window.QTMPL["tpl"]}(t.exports,t,e);e.____MODULES["78bcf0a682326d91379b6f32d0782a68"]=t.exports})(this);(function(e){var t={id:"fa01da1fc3cb98ac72edf12dc7ca3972",filename:"note_img.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){$(function(){$("body").delegate(".img_link .tool-zan","touchend",function(e){var t=$(this);var n=t.data("id");if(n){$.ajax({url:" /youji/image/like/"+n,success:function(){t.addClass("tool-zan-selected")},error:function(){t.addClass("tool-zan-selected")}})}})})}(t.exports,t,e);e.____MODULES["fa01da1fc3cb98ac72edf12dc7ca3972"]=t.exports})(this);(function(e){var t={id:"bd711eae9a1b2e07bc94ea293eec3fd3",filename:"shrink.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){t.exports={start:function(e,t,n,r,i){var n=n||20;var i=i||$("body");var e=e||".js-shrink-text";var t=t||".arrow";var s=i.find(e);var r=r||"arrow-up";var o=parseInt(s.css("line-height"),10);var u=o*n;var a=$("body");s.each(function(e,t){var n=$(this);if(n.height()>u){n.css({height:u,overflow:"hidden"});n.next(".arrow").css("display","block")}});i.delegate(t,"click",function(t){var n=$(this);if(n.hasClass(r)){n.prev(e).css({height:u,overflow:"hidden"});n.removeClass(r);a.scrollTop(n.offset().top-o*3)}else{n.addClass(r);n.prev(e).css({height:"auto",overflow:"auto"})}})}}}(t.exports,t,e);e.____MODULES["bd711eae9a1b2e07bc94ea293eec3fd3"]=t.exports})(this);(function(e){var t={id:"30df41224611b8972b784100fcc84dfb",filename:"note_links.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){t.exports={linkDB:[],linkStore:[],start:function(){this.fetchData()},runTask:function(){var e=this;var t=e.linkDB;for(var n in t){e.replaceLink(n,t[n])}},fetchData:function(e){var t=this;$.get("/app/api/book/poilinks/"+window.SOURCE_ID,{},function(e){if(e&&e.ret){t.linkDB=e.data||{};t.runTask()}})},replaceDestLinks:function(e,t){var n=e.sort(function(e,t){return t.name.length-e.name.length});var r={};var i,s;for(var o=0;o<n.length;o++){var u=n[o];if(u.type==2){var a=u.name.replace(/\s/g,"&nbsp;");i=new RegExp(a,"g");t=t.replace(i,function(e,t){var n=u.id+"-"+o;if(u.subType==1){r[n]='<a data-beacon="text_link" class="plink" href="'+u.url+'">'+e+"</a>"}else{r[n]='<a data-beacon="text_link" class="plink" href="/poi/'+u.id+'">'+e+"</a>"}return"<<"+n+">>"})}}for(var f in r){t=t.replace(new RegExp("<<"+f+">>","g"),r[f])}return t},replaceLink:function(e,t){var n=this;var r=$("#ele-"+e);if(r.length===0){return}var i=".note_img .text_link,.note_img .img_txt,.fontbox .tit";r.find(i).each(function(e,r){var i=$(r);if(i.parent("a").length>0){return}var s=i.html();var o=s;if(t){i.html(n.replaceDestLinks(t,o))}})}}}(t.exports,t,e);e.____MODULES["30df41224611b8972b784100fcc84dfb"]=t.exports})(this);(function(e){var t={id:"85df7b0af5c7c275cc2b62b1b0e3d0e1",filename:"details.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(t,n,r){var i=window;var s=$("body");$.substitute=function(e,t,n){return e.replace(n||/\\?\{([^{}]+)\}/g,function(e,n){if(e.charAt(0)=="\\")return e.slice(1);return t[n]!=null?t[n]:""})};var o=function(e,t){t=t||"yyyy-MM-dd";var n=e.getFullYear().toString(),r={M:e.getMonth()+1,d:e.getDate(),h:e.getHours(),m:e.getMinutes(),s:e.getSeconds()};t=t.replace(/(y+)/ig,function(e,t){return n.substr(4-Math.min(4,t.length))});for(var i in r){t=t.replace(new RegExp("("+i+"+)","g"),function(e,t){return r[i]<10&&t.length>1?"0"+r[i]:r[i]})}return t};i.viewMap=function(e){function i(t){e(t).on("click",function(t){r=e("#wrapper");if(r.length){e("img",r).attr("src",e(this).attr("src"));r.show()}else{e("body").append('<div id="wrapper"><div id="scroller"><img src="'+e(this).attr("src")+'"/></div></div>');r=e("#wrapper")}r.css({top:n.scrollTop()+"px",height:n.height()+"px"});e("#scroller").css({width:e("img",r).width()+"px"});s();o();e(".qn_page").css({visibility:"hidden"})})}function s(){if(t){t.refresh()}else{t=new iScroll("wrapper",{zoom:true})}}function o(){r.on("click",function(){e(this).hide();n.unbind("resize scroll",u);setTimeout(function(){e(".qn_page").css({visibility:"visible"})},50)});n.on("resize scroll",u)}function u(){r.css({top:n.scrollTop()+"px",height:n.height()+"px"});t.refresh()}function a(e){return e.innerText||e.textContent}function f(e,t){if(e.innerText){e.innerText=t}else if(e.textContent){e.textContent=t}}var t,n=e(window),r;return{init:i}}($);(function(e){function p(){e(".b_banner").hide();i.css("visibility","visible");i.show();var t=e(document.body).height();var n=e(window).height();l=t>n?t:n;c=o.height();var r=l>c?l:c;s.css({position:"absolute","z-index":"1000",top:"0",left:"0",height:r+"px"});if(t>n){l=(window.scrollY||document.documentElement.scrollTop)+n}else{l=n}o.css({top:n+"px"});l=n-c;o.animate({top:l+"px"},300)}function y(e,t){var n=m[e];t=t||{};var r=n.url;var i=n.parse(t);var s=g(i);r+="?"+s;window.open(r)}var t="100244931";var n=Object.prototype;var r=encodeURIComponent;var i=e("#sharePanel");var s=i.find(".b_dialog_mask");var o=i.find(".b_dialog");var u=o.find(".btn_cancel");var a=o.find(".share_weibo");var f=o.find(".share_qq");var l;var c;var h=e(".tool-share");h.on("click",function(e){e.preventDefault();p()});s.on("click",function(e){i.hide()});u.on("click",function(e){e.preventDefault();i.hide()});f.on("click",function(e){e.preventDefault();y("qq")});a.on("click",function(e){e.preventDefault();y("weibo")});var d=location.href,v;if(d.indexOf("?")!=-1){v=location.href}else{v=location.href+"?"}var m={weibo:{url:"http://service.weibo.com/share/share.php",parse:function(n){var r=null;return{url:n.url||v+"from=201501sinaweibo",type:"3",count:n.count||r,appkey:n.appkey||t,title:e(window)[0].__SINA_SHARE_CONTENT__||"#去哪儿攻略#"+document.title,pic:n.pic||r,ralateUid:n.uid||r,language:n.language||r,dpc:1}}},qq:{url:"http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey",parse:function(t){return{desc:"#去哪儿攻略#"+document.title,title:e(window)[0].__QZONE_SHARE_CONTENT__||"#去哪儿攻略#"+document.title,summary:e(window)[0].__QZONE_SHARE_CONTENT__||"#去哪儿攻略#"+document.title,url:t.url||v+"from=201501qzone",site:t.site||location.hostname}}}};var g=function(e){var t=[];for(var i in e){var s=i;var o=e[s];if(n.toString.call(o)==="[object Array]"){o=o.join(",")}if(o!=null){o=r(o);t.push(s+"="+o)}}return t.join("&")}})(Zepto);(function(){function f(){var e=a-20;var t=$(".img_link .js_lazyimg");var n,r,i,s;t.each(function(t,s){n=$(s);r=n.data("width");i=n.data("height");img_lastW=r<e?r:e;n.css({width:img_lastW,height:img_lastW*i/r});n.parent(".img_link").css({width:img_lastW})})}var t=$(".qn_page");e.____MODULES["fe84b0b9d47dc2feed8b14b3d6c1c878"];e.____MODULES["8fb16d9363ae8f2faf3362600ace2d11"];var n=e.____MODULES["4a3d74559aceeb301d012ffb24cb52d3"];e.____MODULES["78bcf0a682326d91379b6f32d0782a68"];var r={comment:{url:"//travel.qunar.com/space/comments/touch?",data:{body:"{body}",bookId:i.SOURCE_ID,commentType:10301,csrfToken:$.cookie("csrfToken")}},reply:{url:"//travel.qunar.com/space/comments/reply?",data:{parentId:"{parentId}",body:"{body}",csrfToken:$.cookie("csrfToken")}},more:{url:"/youji/{id}/comments?_json=&page={page}&limit=3",data:{id:"{id}",page:"{page}",csrfToken:$.cookie("csrfToken")}},moreReply:{url:"/youji/{id}/childcomments?_json&page={page}&limit=3",data:{id:"{id}",page:"{page}",csrfToken:$.cookie("csrfToken")}}};i.Comment={init:function(){var e=this;e.container=$("div.comment");e.containerList=e.container.find(".dl-comment");e.numEle=$(".tool-comment em,.comment .titles span");e.commentNum=e.numEle.text()*1||0;e.commentPage=1;e.initEvents()},initEvents:function(){var e=this;e.container.delegate("#commentHandle","click",$.proxy(e.showPanel,e));e.container.delegate(".more-comment","click",$.proxy(e.getMore,e));e.container.delegate(".more-reply","click",$.proxy(e.getMoreReply,e));s.delegate(".replys","click",$.proxy(e.showPanel,e));s.delegate(".pop-comment-bt","click",$.proxy(e.post,e));s.delegate(".pop-comment-text","input propertychange",$.proxy(e.showBtTip,e))},toggleMore:function(){var e=this;e.container.find(".more-comment").parent("dd").remove()},getMore:function(e){var t=this;e.preventDefault();if($(e.target).is("[data-none]")){return}t.commentPage=t.commentPage+1;var n=$.substitute(r["more"]["url"],{page:t.commentPage,id:i.SOURCE_ID})+"&callback=?";$.ajaxJSONP({url:n,success:function(e){if(!!e){if(e.errcode===0){t.afterSuccess(e.data,"more")}}}})},getMoreReply:function(e){var t=this;e.preventDefault();var n=$(e.target);var i;var s=n.parent().parent().data("page");if(s==undefined){i=2}else{i=s+1}n.parent().parent().data("page",i);var o=n.data("id");var u=$.substitute(r["moreReply"]["url"],{page:i,id:o})+"&callback=?";$.ajaxJSONP({url:u,success:function(e){if(!!e){if(e.errcode===0){var t=this;n.parent("dd").remove();$(e.data.html).appendTo($(".dl-comment").find("dd[data-replyid='"+o+"']").find(".dl-reply"))}}}})},showPanel:function(e){var t=this;var r=$(e.target);$(".b_banner").hide();if(r.is(".replys")){t.type="reply"}else{t.type="comment"}n.show({id:"pop-comment",afterShowed:function(e){var t=e.container.find("textarea");t.focus()}});if(!t.textEle){var i=n.get({id:"pop-comment"});t.textEle=$(".pop-comment-text");t.tipEle=$(".pop-tips");t.butEle=$(".pop-comment-bt")}t.reset(r)},format:function(){var e=this;var t=e.type;var n={body:$.trim(e.textEle.val())};if(t==="reply"){n.parentId=e.parentId}return $.param($.extend(r[t]["data"],n))},showBtTip:function(){var e=this;e.value=$.trim(e.textEle.val());if(e.value!=""){e.butEle.removeClass("pop-comment-bt-disabled")}else{e.butEle.addClass("pop-comment-bt-disabled")}},showTip:function(e){var t=this;t.tipEle.text(e.errmsg)},reset:function(e){var t=this;var n=t.type;if(n==="comment"){t.textEle.attr("placeholder","说点什么吧~");t.parentId=null}else{t.parentId=e.data("id");t.textEle.attr("placeholder","回复 "+e.data("username"))}t.textEle.val("");t.tipEle.text("")},afterSuccess:function(e,t){var r=this;if(!!t){r.toggleMore();$(e.html).appendTo(r.containerList)}else{e.comment.modifyTime=o(new Date(e.comment.modifyTime),"MM月dd日 h:s");if(r.type=="comment"){e.comment.ctype=r.type;var i=QTMPL.tpl.render(e.comment);$(i).prependTo(r.containerList);n.get({id:"pop-comment"}).hide();r.container.get(0).scrollIntoView();r.commentNum+=1;r.numEle.text(r.commentNum)}else{var i=QTMPL.tpl.render(e.comment);var s,u;var a=$("span[data-id='"+r.parentId+"']").parent();var f=a.parent().parent(".comment-reply");if(f.length!=0){s=$(r.containerList).find("dd[data-replyid='"+f.data("replyid")+"']").find(".dl-reply");u=$(r.containerList).find("span[data-id='"+f.data("replyid")+"']")}else{s=$(r.containerList).find("dd[data-replyid='"+r.parentId+"']").find(".dl-reply");u=$(r.containerList).find("span[data-id='"+r.parentId+"']")}$(i).prependTo(s);var l=u.find(".num_none em").text()*1||0;l+=1;u.find(".num_none").removeClass("hide");u.find(".num_none em").text(l);n.get({id:"pop-comment"}).hide();r.container.get(0).scrollIntoView();r.commentNum+=1;r.numEle.text(r.commentNum)}}},post:function(){var e=this;var t=r[e.type]["url"]+e.format()+"&callback=?";if(!e.value){e.textEle.focus();return}$.ajaxJSONP({url:t,success:function(t){if(!!t){if(t.errcode===0){e.afterSuccess(t.data)}else if(t.errcode===7){i.location.href=i.location.protocol+"//user.qunar.com/mobile/login.jsp?ret="+location.href}else if(t.errcode===10311||t.errcode===13){e.showTip(t)}else if(t.errcode===14){i.location.href=i.location.protocol+"//touch.qunar.com/h5/user/mobilemaintain?action=viewmodify"}else{e.showTip(t)}}else{e.showTip(t)}}})}};Comment.init();var u={init:function(){var e=this;e.handleEle=$(".tool .tool-zan");e.element=e.handleEle.find("em");e.count=e.element.text()*1||0;e._cookie=($.cookie("digg")||"").split("|");e.initEvents();e.initDiggView()},initDiggView:function(){if(!this.check(i.SOURCE_ID)){this.handleEle.addClass("tool-zan-selected")}},initEvents:function(){var e=this;e.handleEle.on("tap",$.proxy(e.digg,e))},digg:function(){var e=this;var t=i.SOURCE_ID;if(e.check(t)){$.ajaxJSONP({url:$.substitute("//travel.qunar.com/youji/like/{id}?callback=?",{id:t}),success:function(n){e.handleEle.addClass("tool-zan-selected");if(n&&n.errcode===0){e.element.text(e.count+1);e._cookie.push(t);$.cookie("digg",e._cookie.join("|"))}}})}},check:function(e){var t=this;if(t._cookie.indexOf(e)===-1){return true}}};u.init();var a=$("body").width();$(".tool-comment").on("click",function(){$(".comment").get(0).scrollIntoView()});$(window).on("resize",function(){f()});$(window).resize()})();e.____MODULES["fa01da1fc3cb98ac72edf12dc7ca3972"];(function(){$("#open-app").on("click",function(){$(".e_banner").click()})})();var u=e.____MODULES["bd711eae9a1b2e07bc94ea293eec3fd3"];var a=e.____MODULES["30df41224611b8972b784100fcc84dfb"];(function(e,t,n,r,i,s){e(function(){a.start();t.initBackBtn("a.arrow_left");n.init(".tool");r.init("div.b_banner.hide");s.init(".mapbox img");i.init($SID);u.start();e("#travelOrder .planbox .hotelpoi").click(function(){i.send($SID,"touch_poi_hotels")});e(window).scroll()})})($,Utils,BackTop,ADManager,TouchLog,viewMap)}(t.exports,t,e);e.____MODULES["85df7b0af5c7c275cc2b62b1b0e3d0e1"]=t.exports})(this);(function(e){var t={id:"900aea1f6f9134ba459ec7aac60800c2",filename:"app_redirect.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){(function(){function m(e,t){var n=t?t:window.location.href;var r=new RegExp("[?&]"+e+"=([^&#]*)","i");var i=r.exec(n);return i?i[1]:null}function w(){this.init.apply(this,arguments)}function E(t){var r=t.appLink;if(r){var i=n==="ios"?"i":"a";var s="qunar"+i+"phone://hy?type=navibar-none&url="+encodeURIComponent(r);e.location.href=s}}var e=window;var t=navigator.userAgent;var n=null!=t.match(/iPhone|iPod|iPad/i)?"ios":"android";var r=!!t.match(/MicroMessenger/i)?true:false;var i="";var s="http://a.app.qq.com/o/simple.jsp?pkgname=com.qunar.travelplan";var o=e.SOURCE_ID;var u=e.SOURCE_NAME;var a=e.TYPE;var f=$(".btn_download, .text_download, .distance .success, .js_banner_ele, #js_btnqrcode");var l=n=="ios"&&t.match(/OS(\s+)9\_/g)?true:null;var c={plan:1,poi:3,SMARTLIST:2,invite:0};var h;var p=function(e,t){if(e!==""){return e+t.slice(0,1).toUpperCase()+t.slice(1)}return t};var d=function(){if(v){return document[p(h,"hidden")]}};var v=function(){var e=false;if(typeof window.screenX==="number"){["webkit","moz","ms","o",""].forEach(function(t){if(e==false&&document[t+(t?"H":"h")+"idden"]+""!=="undefined"){e=true;h=t}})}return e}();var g=function(e,t){if(v&&typeof e==="function"){return document.addEventListener(h+"visibilitychange",function(t){e.call(this,t)},t)}};var y=decodeURIComponent(m("userid"));switch(a){case"plan":case"poi":i=a+"?id="+o;break;case"city":case"country":i=a+"?id="+o+"&name="+u;break;case"invite":i="launch?type=1&param="+y||"";break;default:i="launch";break}var b=window.navigator.userAgent.toLowerCase();w.prototype={constructor:w,init:function(e){var t=this,n=t.options=$.extend({},e);t.bindEvents(t,n)},bindEvents:function(t,n){f.on("click",$.proxy(t.attemptOpen,t));if(v){g($.proxy(t.hide,t))}else{e.addEventListener("blur",$.proxy(t.hide,t))}},hide:function(){var e=this;e.pending=false},checkInApp:function(){if(b.indexOf("micromessenger")>0){return"js_weixin_shadow"}else if(b.indexOf("weibo")>0){return"js_weibo_shadow"}else if(b.indexOf(" qq/")>0){return"js_qq_shadow"}else{return""}},hasShadows:function(){return $(".shadow").length>0},showPop:function(){var e=this.checkInApp();if(e){$("#"+e).show()}},ios9Check:function(){if(!this.checkInApp()){return}if(!this.hasShadows()){return false}if(b.indexOf("weibo")>0||b.indexOf(" qq/")>0){this.showPop();return true}if(!l){this.showPop();return true}},attemptOpen:function(e){e.stopPropagation();e.preventDefault();if((b.indexOf("qunartraveliphone")>0||b.indexOf("qunartravelaphone")>0)&&$("#js_btnqrcode").length>0){location.href="com.qunar.gonglue://launch?type=2";return false}if(this.ios9Check()){return}var t="";if(n==="ios"){var u=a=="invite"?',"param":"'+(y||"")+'"':'"id":'+o;var f=c[a]?',"pageType":'+c[a]:"";t="https://travel.qunar.com/openapp"+(r?"wx":"")+"/?"+encodeURIComponent("{"+u+f+"}")}else{t=s}location.href="com.qunar.gonglue://"+i;setTimeout(function(){location.href=t},250);setTimeout(function(){location.reload()},1e3)},autoLaunchApp:function(){if(b.indexOf("qunariphone")>0||b.indexOf("qunaraphone")>0){return false}var e=null;switch(a){case"plan":e={appLink:"https://hy.travel.qunar.com/page#/youji/"+o+"?bd_source=auto_launch"};break;case"poi":e={appLink:"https://hy.travel.qunar.com/page#/poi/normal/"+o+"?bd_source=auto_launch"};break;case"SMARTLIST":e={appLink:"https://hy.travel.qunar.com/page#/smartlist/"+o+"?bd_source=auto_launch"};break}if(e!==null){E(e)}}};e.App=e.App||new w;var S=true;if("2"==e.POI_TYPE){S=false}if(S){e.App.autoLaunchApp()}})()}(t.exports,t,e);e.____MODULES["900aea1f6f9134ba459ec7aac60800c2"]=t.exports})(this);(function(e){var t={id:"5068b933762ad9931ceca97a80346853",filename:"link_more.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){(function(){var e={init:function(){var e=this;e.container=$(".planbox");e.btn=e.container.find(".load_more");e.num=0;e.hide=$("");e.con=$("");e.initEvent()},initEvent:function(){var e=this;e.container.click(function(t){e.con=$(event.target);e.hide=e.con.siblings(".note_img").find(".hide");e.num=e.hide.length;if(e.con.is(".load_more")){t.preventDefault();e.show()}else{}})},show:function(){var e=this;if(e.num>10){e.hide.slice(0,10).removeClass("hide")}else{e.hide.removeClass("hide");e.con.hide()}}};e.init()})()}(t.exports,t,e);e.____MODULES["5068b933762ad9931ceca97a80346853"]=t.exports})(this);(function(e){var t={id:"b069761fbd7591a19c3e08bd4c661eb4",filename:"lazyload.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){(function(e,t,n,r){var i=e(t);e.fn.lazyload=function(s){function f(){var t=0;o.each(function(){var n=e(this);if(e.abovethetop(this,a)||e.leftofbegin(this,a)){}else if(!e.belowthefold(this,a)&&!e.rightoffold(this,a)){n.trigger("appear");t=0}else{if(++t>a.failure_limit){return false}}})}var o=this;var u;var a={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:t,data_attribute:"original",skip_invisible:true,appear:null,load:null,placeholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC",after_loaded:function(){}};if(s){if(r!==s.failurelimit){s.failure_limit=s.failurelimit;delete s.failurelimit}if(r!==s.effectspeed){s.effect_speed=s.effectspeed;delete s.effectspeed}e.extend(a,s)}u=a.container===r||a.container===t?i:e(a.container);if(0===a.event.indexOf("scroll")){u.bind(a.event,function(){return f()})}this.each(function(){var t=this;var n=e(t);t.loaded=false;if(n.attr("src")===r||n.attr("src")===false){if(n.is("img")){n.attr("src",a.placeholder)}}n.one("appear",function(){if(!this.loaded){if(a.appear){var r=o.length;a.appear.call(t,r,a)}e("<img />").bind("load",function(){var r=n.attr("data-"+a.data_attribute);n.hide();if(n.is("img")){n.attr("src",r)}else{n.css("background-image","url('"+r+"')")}n[a.effect](a.effect_speed);a.after_loaded.call(n,n.width(),n.height());t.loaded=true;var i=e.grep(o,function(e){return!e.loaded});o=e(i);if(a.load){var s=o.length;a.load.call(t,s,a)}}).attr("src",n.attr("data-"+a.data_attribute))}});if(0!==a.event.indexOf("scroll")){n.bind(a.event,function(){if(!t.loaded){n.trigger("appear")}})}});i.bind("resize",function(){f()});if(/(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion)){i.bind("pageshow",function(t){if(t.originalEvent&&t.originalEvent.persisted){o.each(function(){e(this).trigger("appear")})}})}e(n).ready(function(){f()});return this};e.belowthefold=function(n,s){var o;if(s.container===r||s.container===t){o=(t.innerHeight?t.innerHeight:i.height())+i.scrollTop()}else{o=e(s.container).offset().top+e(s.container).height()}return o<=e(n).offset().top-s.threshold};e.rightoffold=function(n,s){var o;if(s.container===r||s.container===t){o=i.width()}else{o=e(s.container).offset().left+e(s.container).width()}return o<=e(n).offset().left-s.threshold};e.abovethetop=function(n,s){var o;if(s.container===r||s.container===t){o=i.scrollTop()}else{o=e(s.container).offset().top}return o>=e(n).offset().top+s.threshold+e(n).height()};e.leftofbegin=function(n,i){var s;if(i.container===r||i.container===t){}else{s=e(i.container).offset().left}return s>=e(n).offset().left+i.threshold+e(n).width()};e.inviewport=function(t,n){return!e.rightoffold(t,n)&&!e.leftofbegin(t,n)&&!e.belowthefold(t,n)&&!e.abovethetop(t,n)}})($,window,document)}(t.exports,t,e);e.____MODULES["b069761fbd7591a19c3e08bd4c661eb4"]=t.exports})(this);(function(e){var t={id:"0d78202eb6d63edc71a3f1bd8da6869f",filename:"details.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(t,n,r){e.____MODULES["c79a1fa2c06d5ee8eff23d2a3c35062e"];e.____MODULES["5a342440e6501b9ab1684e1edea13c8b"];e.____MODULES["cc2198adce492a7016cb60052004643a"];e.____MODULES["b50c95c8796bb5ba1a3d6cf1366212a8"];e.____MODULES["aec70870051e386eb31d0d90b1f91396"];e.____MODULES["81534f819dbb8f857997bf1900f5d6a6"];e.____MODULES["85df7b0af5c7c275cc2b62b1b0e3d0e1"];e.____MODULES["900aea1f6f9134ba459ec7aac60800c2"];e.____MODULES["5068b933762ad9931ceca97a80346853"];e.____MODULES["b069761fbd7591a19c3e08bd4c661eb4"];$("body").find(".img_link .js_lazyimg").lazyload({data_attribute:"src",threshold:400,after_loaded:function(e,t){}})}(t.exports,t,e);e.____MODULES["0d78202eb6d63edc71a3f1bd8da6869f"]=t.exports})(this)